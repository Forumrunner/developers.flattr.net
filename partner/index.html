<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />

  <title>Partner site integration - Flattr Developers</title>

  <link rel="stylesheet" href="/styles/base.css">
  <link rel="stylesheet" href="/styles/custom.css">
  <link rel="stylesheet" href="/styles/syntax.css">
  <link rel="shortcut icon" href="/favicon.ico">
	<link rel="payment" type="text/html" href="https://flattr.com/submit/auto?url=http%3A%2F%2Fdevelopers.flattr.net">
</head>
<body>
  <div class="container">
    <h1><a href="/">Flattr Developer Platform</a></h1>

    <ul class="nav">
      <li>
        <a href="/api">REST API</a>
        <ul>
          <li><a href="/api/">Introduction</a></li>
          <li><a href="/api/#authorization">Authorization</a></li>
          <li>
            <span>Resources</span>
            <ul>
              <li><a href="/api/resources/flattrs">Flattrs</a></li>
              <li><a href="/api/resources/things">Things</a></li>
              <li><a href="/api/resources/subscriptions">Subscriptions</a></li>
              <li><a href="/api/resources/users">Users</a></li>
              <li><a href="/api/resources/activities">Activities</a></li>
              <li><a href="/api/resources/categories">Categories</a></li>
              <li><a href="/api/resources/languages">Languages</a></li>
            </ul>
          </li>
          <li><a href="http://console.apihq.com/api/flattr" target="_blank">Console</a></li>
          <li><a href="/api/changelog">Changelog</a></li>
          <li><a href="/api/libraries">Clients</a></li>
          <li><a href="/api/policy">Policy</a></li>
        </ul>
      </li>
      <li><a href="/button">Embedded buttons</a></li>
      <li><a href="/auto-submit">Auto-submit URL</a></li>
      <li><a href="/feed">Flattr in feeds and HTML</a></li>
      <li><a href="/partner">Partner site integration</a></li>
      <li><a href="/tools">Tools</a></li>
      <li><a href="/api/questions">Questions</a></li>

    </ul>

    <div class="page">
      <div class="header">
        <h2>Partner site integration</h2>
        <div class="subtitle"></div>
      </div>
      <p>This documentation is for Flattr Partners.</p>

<p>You can apply for partnership over at our <a href="https://partner.flattr.com">partnership site</a>.</p>
<h3 id="revenue-sharing">Revenue Sharing</h3>
<p>To take part in revenue sharing with Flattr you need to generate a Revenue Sharing Key on our <a href="https://partner.flattr.com">partner site</a>. This key is unique and used to identify all the flattrs you make as a partner on Flattr.</p>
<h4 id="revenue-sharing-with-embedded-button/auto-submit">Revenue Sharing with Embedded button/Auto-submit</h4>
<p>If you use javascript buttons in your Flattr integration you need to add your revshare key ( available on
the <a href="https://partner.flattr.com">partner site</a> to either the Flattr javascript or to a attribute on the
Flattr button.</p>

<p><strong>Example: Add revenue sharing key to the Flattr Javascript</strong></p>
<div class="highlight"><pre><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
<span class="cm">/* &lt;![CDATA[ */</span>
<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

    <span class="nx">s</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;text/javascript&#39;</span><span class="p">;</span>
    <span class="nx">s</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">s</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;//api.flattr.com/js/0.6/load.js&#39;</span><span class="o">+</span>
        <span class="s1">&#39;?mode=auto&amp;revsharekey=YOUR_REVENUE_SHARING_KEY&#39;</span><span class="p">;</span>

    <span class="nx">t</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">t</span><span class="p">);</span>
 <span class="p">})();</span>
<span class="cm">/* ]]&gt; */</span>
<span class="o">&lt;</span><span class="err">/script&gt;</span>
</pre>
</div>

<p><strong>Example: Add the revenue sharing key as a data-flattr attribute on the link HTML tag</strong></p>
<div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">&quot;FlattrButton&quot;</span> <span class="na">style=</span><span class="s">&quot;display:none;&quot;</span>
    <span class="na">title=</span><span class="s">&quot;This is my title&quot;</span>
    <span class="na">data-flattr-uid=</span><span class="s">&quot;flattr&quot;</span>
    <span class="na">data-flattr-tags=</span><span class="s">&quot;text, opensource&quot;</span>
    <span class="na">data-flattr-category=</span><span class="s">&quot;text&quot;</span>
    <span class="na">data-flattr-revsharekey=</span><span class="s">&quot;YOUR_REVENUE_SHARING_KEY&quot;</span>
    <span class="na">href=</span><span class="s">&quot;http://wp.local/?p=444&quot;</span><span class="nt">&gt;</span>

    Lorem ipsum dolor sit amet, consectetur adipiscing elit.
    Lorem ipsum dolor sit amet, consectetur adipiscing
    Maecenas aliquet aliquam leo quis fringilla.
<span class="nt">&lt;/a&gt;</span>
</pre>
</div>
<h4 id="rest-api">REST API</h4>
<p>If you are flattering through our REST API you need to make certain that your Revenue Sharing Key is connected to your Application on the <a href="http://partner.flattr.com">partner site</a>. If it is, you won&#39;t need to do anything futher.</p>
<h3 id="partner-namespaces">Partner namespaces</h3><h4 id="introduction">Introduction</h4>
<p>Partner namespaces is a way for partners to create Things for their users&#39; content without the user having to preregister at Flattr. When the user later on signs up for Flattr they will receive all the pending flattrs and gain ownership of all of their Things.</p>

<p>The mechanism uses non-flattr user identifiers to identify ownership of the things and lets the user claim it&#39;s things and flattrs by later confirming that its the rightful owner of that identifier.</p>

<p>Namespaces are created in dialog with Flattr, so <a href="https://flattr.com/contact">contact us</a> and we can discuss futher.</p>

<p>Web Hook Callbacks are supported for notifying partners when something happens to one of their users unclaimed things - such as them receiving flattrs. That way partners can easily communicate what is happening on Flattr to their users and make them aware that they have flattrs to claim..</p>
<h4 id="auto-submit-/-embedded-buttons">Auto-submit / Embedded buttons</h4>
<p>The first step is to add a way for users to be able to flattr the content on your site.</p>

<p>The best user experience is achieved by using our javascript based <a href="/button">embedded buttons</a> which embeds buttons as iframes through which logged in users can flattr right away.</p>

<p>If for any reason embedded buttons won&#39;t work one can instead use our static auto-submit to open a page on Flattr.com with the thing on which it can be flattred.</p>

<p>Through the auto-submit process (auto-submitting means that a Flattr thing is created automatically when the first flattr is made - they don&#39;t have to be presubmitted) the description of the thing is currently also added - the name, category, language etc.</p>

<p><strong>However</strong> - we&#39;re looking at moving away from auto-submit provided description data in the <em>future</em> and fetch the description of the thing from its URL instead - using <a href="http://ogp.me/">Open Graph</a> data or similar. Partners need to keep this in mind when choosing URL:s for their things. Feedback is also welcome.</p>
<h5 >Embedded Buttons</h5>
<p><a href="/button">Embedded buttons</a> for partners work the same way as a normal Flattr button.</p>

<p>The difference between normal buttons and the ones used by partners is that a partner may assign an <code>owner</code> parameter instead of the <code>uid</code> parameter used by ordinary buttons. The owner parameter contains an identifier for a non-flattr user. See a list of supported identifiers in the section <a href="#supported-user-identifiers">Supported user identifiers</a> at the end of this document.</p>
<h5 >Static Auto-submit</h5>
<p>The static auto-submit is a link that redirects to either an existing thing or to a temporary page where the thing can be flattred and thus also created through the auto-submit.</p>

<p>The basic URL for the static auto-submit is <code>https://flattr.com/submit/auto</code> and to that a couple of query parameters are added see <a href="/button">embedded button documentation</a>.
As with the Embedded buttons, a partner may assign an <code>owner</code> instead of the <code>uid</code> parameter.</p>

<p><strong>Example Auto-submit URL</strong>   </p>

<p><code>https://flattr.com/submit/auto?url=http://example.com/&amp;owner=twitter:user:id:123&amp;title=Example</code></p>
<h4 id="web-hook-callbacks">Web Hook callbacks</h4>
<p>For partners to get notified when something happens to their site&#39;s unclaimed things we have added support for web hooks - this means that partners can pass the notification on to the owner of thing so that partners can be sure that the user knows about it.</p>

<p>A single web hook URL is registered with us and which events that should be sent to it. Whenever an event occurs we do a POST-request to that URL with a form encoded body containing event specific parameters as well as a <code>_event</code> parameter indicating the type of event. Partner sites should always check the <code>_event</code> parameter prior to processing an event to be sure that they are processing the right event.</p>
<h4 id="available-web-hook-events">Available Web Hook Events</h4><h5 >Unclaimed thing receives a pending flattr</h5>
<p><strong>Event name:</strong> <code>pendingclickcreate</code></p>

<p><strong>Parameters:</strong></p>

<ul>
<li><strong>thing_id</strong> - The numeric id of the thing that was clicked</li>
<li><strong>thing_owner_id</strong> - The full user identifier specified for the thing.</li>
<li><strong>thing_clicks_total</strong> - The total amount of clicks after this click happened. (While hooks are likely to be executed in order - don&#39;t count on it)</li>
<li><strong>flattrer_username</strong> - The username of the user that did the flattr - or empty if the user flattrs anonymously</li>
<li><strong>claim_url</strong> - URL to a page on Flattr.com where the user can claim their things. If the owner was specified as an e-mail address then append the unhashed e-mail address to the claim url like &quot;/owner/foo%40example.com&quot;.</li>
</ul>
<h4 id="supported-user-identifiers">Supported user identifiers</h4>
<ul>
<li>E-mail addresses, MD5 hashed. Eg: <code>email:05f8b3480b04f6a516bb1a46e556323c</code></li>
<li>Twitter user ids. Eg. <code>twitter:user:id:123</code></li>
<li>Partner ids. Eg. <code>partner:customnamespace:123</code></li>
</ul>

<p>If you think a identifier is missing don&#39;t hesitate <a href="https://flattr.com/contact">contacting
us</a> about it.</p>
<h4 id="verifying-custom-identifiers">Verifying custom identifiers</h4>
<p>If we have arranged it so that you can verify that a given Flattr account is owned by a user on your system, you can use a API call to associate the two accounts. This will make all pending things associated with the user on your system to automatically be claimed by the Flattr account.</p>
<h5 >Parameters</h5>
<ul>
<li><strong>identity</strong> - The URI that you want to associate with the Flattr account, e.g. <code>partner:customnamespace:123</code> where <code>123</code> is e.g. the ID number of a user on your system. Contact us if you do not know what your partner namespace is.</li>
</ul>
<h5 >Request</h5><pre class="highlight"><code>POST https://api.flattr.com/rest/v2/users/:username/verify
</code></pre><h5 >Verify an authenticated user</h5><pre class="highlight"><code>POST https://api.flattr.com/rest/v2/user/verify
</code></pre><h5 >Example response</h5>
<pre class="headers"><code>HTTP/1.1 200 OK
Content-Type: application/json;charset=utf-8
X-RateLimit-Limit: 1000
X-RateLimit-Remaining: 999
X-RateLimit-Current: 1
X-RateLimit-Reset: 1342521939</code></pre>
<h5 >Errors</h5>
<ul>
<li><code>unauthorized</code>  (401 Unauthorized) - You are either not logged in, are providing an invalid identifier, or are not allowed to verify the provided identifier.</li>
</ul>

    </div>
    <address>Visit <a href="http://flattr.com/">Flattr.com</a> to learn more about Flattr.</address>

  </div>

  <script src="/js/ender.js"></script>
  
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-13236450-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>
</html>
